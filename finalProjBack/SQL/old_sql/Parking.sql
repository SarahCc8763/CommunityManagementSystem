-- Julie 停車場的部分

-- 要放在振宇哥的社區公告後面 !!

CREATE TABLE parking_type (
    id INT IDENTITY(1,1) PRIMARY KEY,         -- 流水號

    community_id INT NOT NULL,                -- 所屬社區
    [type] NVARCHAR(10) NOT NULL,               -- 車位種類

    -- FK 約束
    CONSTRAINT FK_parking_type_community FOREIGN KEY (community_id)
        REFERENCES community(id)
);

INSERT INTO parking_type ([type], community_id)
VALUES
(N'汽車', 1),
(N'機車', 1),
(N'電動車', 1);

CREATE TABLE parking_slot (
    id INT IDENTITY(1,1) PRIMARY KEY, -- 流水號

    community_id INT NOT NULL,        -- 所屬社區
    parking_type_id INT NOT NULL,     -- 車位種類
    users_id INT NOT NULL,            -- 擁有人（可為 null）
    
    slot_number NVARCHAR(10) NOT NULL,  -- 車位代碼
    location NVARCHAR(20),              -- 位置
    license_plate NVARCHAR(10),         -- 登記車牌
    is_rentable BIT NOT NULL,           -- 是否可承租

    -- FK 約束
    CONSTRAINT FK_parking_slot_community FOREIGN KEY (community_id) 
        REFERENCES community(id),

    CONSTRAINT FK_parking_slot_parking_type FOREIGN KEY (parking_type_id) 
        REFERENCES parking_type(id),

    CONSTRAINT FK_parking_slot_users FOREIGN KEY (users_id) 
        REFERENCES users(users_id),

    -- 唯一約束：同一社區內車位代碼唯一
    CONSTRAINT UQ_parking_slot_community_slot UNIQUE (community_id, slot_number)
);

INSERT INTO parking_slot (
    slot_number, [location], parking_type_id,
    users_id, license_plate, is_rentable, community_id
)
VALUES
-- 社區車位 (可承租)
(N'B1-001', N'B1 A區', 1, 145, NULL, 1, 1),
(N'B1-002', N'B1 A區', 1, 145, NULL, 1, 1),
(N'B1-003', N'B1 A區', 1, 145, NULL, 1, 1),
(N'B1-004', N'B1 A區', 1, 145, NULL, 1, 1),
(N'B1-005', N'B1 A區', 1, 145, NULL, 1, 1),
(N'B1-006', N'B1 A區', 1, 145, NULL, 1, 1),
(N'B1-007', N'B1 A區', 1, 145, NULL, 1, 1),
(N'B1-008', N'B1 A區', 1, 145, NULL, 1, 1),
(N'B1-009', N'B1 A區', 1, 145, NULL, 1, 1),
(N'B1-010', N'B1 A區', 1, 145, NULL, 1, 1),
(N'B1-011', N'B1 B區', 1, 145, NULL, 1, 1),
(N'B1-012', N'B1 B區', 1, 145, NULL, 1, 1),
(N'B1-013', N'B1 B區', 1, 145, NULL, 1, 1),
(N'B1-014', N'B1 B區', 1, 145, NULL, 1, 1),
(N'B1-015', N'B1 B區', 1, 145, NULL, 1, 1),
(N'B1-016', N'B1 B區', 1, 145, NULL, 1, 1),
(N'B1-017', N'B1 B區', 1, 145, NULL, 1, 1),
(N'B1-018', N'B1 B區', 1, 145, NULL, 1, 1),
(N'B1-019', N'B1 B區', 1, 145, NULL, 1, 1),
(N'B1-020', N'B1 B區', 1, 145, NULL, 1, 1),
(N'B1-021', N'B1 C區', 2, 145, NULL, 1, 1),
(N'B1-022', N'B1 C區', 2, 145, NULL, 1, 1),
(N'B1-023', N'B1 C區', 2, 145, NULL, 1, 1),
(N'B1-024', N'B1 C區', 2, 145, NULL, 1, 1),
(N'B1-025', N'B1 C區', 2, 145, NULL, 1, 1),
(N'B1-026', N'B1 C區', 2, 145, NULL, 1, 1),
(N'B1-027', N'B1 C區', 2, 145, NULL, 1, 1),
(N'B1-028', N'B1 C區', 2, 145, NULL, 1, 1),
(N'B1-029', N'B1 C區', 2, 145, NULL, 1, 1),
(N'B1-030', N'B1 C區', 2, 145, NULL, 1, 1),
(N'B1-031', N'B1 D區', 2, 145, NULL, 1, 1),
(N'B1-032', N'B1 D區', 2, 145, NULL, 1, 1),
(N'B1-033', N'B1 D區', 2, 145, NULL, 1, 1),
(N'B1-034', N'B1 D區', 2, 145, NULL, 1, 1),
(N'B1-035', N'B1 D區', 2, 145, NULL, 1, 1),
(N'B1-036', N'B1 D區', 2, 145, NULL, 1, 1),
(N'B1-037', N'B1 D區', 2, 145, NULL, 1, 1),
(N'B1-038', N'B1 D區', 2, 145, NULL, 1, 1),
(N'B1-039', N'B1 D區', 2, 145, NULL, 1, 1),
(N'B1-040', N'B1 D區', 2, 145, NULL, 1, 1),
(N'B1-041', N'B1 E區', 3, 145, NULL, 1, 1),
(N'B1-042', N'B1 E區', 3, 145, NULL, 1, 1),
(N'B1-043', N'B1 E區', 3, 145, NULL, 1, 1),
(N'B1-044', N'B1 E區', 3, 145, NULL, 1, 1),
(N'B1-045', N'B1 E區', 3, 145, NULL, 1, 1),
(N'B1-046', N'B1 E區', 3, 145, NULL, 1, 1),
(N'B1-047', N'B1 E區', 3, 145, NULL, 1, 1),
(N'B1-048', N'B1 E區', 3, 145, NULL, 1, 1),
(N'B1-049', N'B1 E區', 3, 145, NULL, 1, 1),
(N'B1-050', N'B1 E區', 3, 145, NULL, 1, 1),
(N'B1-051', N'B1 F區', 3, 145, NULL, 1, 1),
(N'B1-052', N'B1 F區', 3, 145, NULL, 1, 1),
(N'B1-053', N'B1 F區', 3, 145, NULL, 1, 1),
(N'B1-054', N'B1 F區', 3, 145, NULL, 1, 1),
(N'B1-055', N'B1 F區', 3, 145, NULL, 1, 1),
(N'B1-056', N'B1 F區', 3, 145, NULL, 1, 1),
(N'B1-057', N'B1 F區', 3, 145, NULL, 1, 1),
(N'B1-058', N'B1 F區', 3, 145, NULL, 1, 1),
(N'B1-059', N'B1 F區', 3, 145, NULL, 1, 1),
(N'B1-060', N'B1 F區', 3, 145, NULL, 1, 1),

-- 私人車位 (不可承租)
(N'B2-001', N'B2 A區', 1, 1, N'BWL-3951', 0, 1),
(N'B2-002', N'B2 A區', 1, 2, N'YMN-8042', 0, 1),
(N'B2-003', N'B2 A區', 1, 3, N'DQR-1397', 0, 1),
(N'B2-004', N'B2 A區', 1, 4, N'MVC-6174', 0, 1),
(N'B2-005', N'B2 A區', 1, 5, N'ZJP-2809', 0, 1),
(N'B2-006', N'B2 A區', 1, 6, N'GXL-4016', 0, 1),
(N'B2-007', N'B2 A區', 1, 7, N'NAH-7625', 0, 1),
(N'B2-008', N'B2 A區', 1, 8, N'CTU-9280', 0, 1),
(N'B2-009', N'B2 A區', 1, 9, N'RFD-6437', 0, 1),
(N'B2-010', N'B2 A區', 1, 10, N'KTF-7283', 0, 1),
(N'B2-011', N'B2 B區', 1, 145, NULL, 0, 1),
(N'B2-012', N'B2 B區', 1, 145, NULL, 0, 1),
(N'B2-013', N'B2 B區', 1, 145, NULL, 0, 1),
(N'B2-014', N'B2 B區', 1, 145, NULL, 0, 1),
(N'B2-015', N'B2 B區', 1, 145, NULL, 0, 1),
(N'B2-016', N'B2 B區', 1, 145, NULL, 0, 1),
(N'B2-017', N'B2 B區', 1, 145, NULL, 0, 1),
(N'B2-018', N'B2 B區', 1, 145, NULL, 0, 1),
(N'B2-019', N'B2 B區', 1, 145, NULL, 0, 1),
(N'B2-020', N'B2 B區', 1, 145, NULL, 0, 1),
(N'B2-021', N'B2 C區', 2, 1, N'AB-3241', 0, 1),
(N'B2-022', N'B2 C區', 2, 2, N'RT-2650', 0, 1),
(N'B2-023', N'B2 C區', 2, 3, N'HK-9873', 0, 1),
(N'B2-024', N'B2 C區', 2, 4, N'JG-7305', 0, 1),
(N'B2-025', N'B2 C區', 2, 5, N'MW-1052', 0, 1),
(N'B2-026', N'B2 C區', 2, 6, N'ZN-8936', 0, 1),
(N'B2-027', N'B2 C區', 2, 7, N'DE-1748', 0, 1),
(N'B2-028', N'B2 C區', 2, 8, N'XP-6620', 0, 1),
(N'B2-029', N'B2 C區', 2, 9, N'CY-5471', 0, 1),
(N'B2-030', N'B2 C區', 2, 10, N'LN-8039', 0, 1),
(N'B2-031', N'B2 D區', 2, 145, NULL, 0, 1),
(N'B2-032', N'B2 D區', 2, 145, NULL, 0, 1),
(N'B2-033', N'B2 D區', 2, 145, NULL, 0, 1),
(N'B2-034', N'B2 D區', 2, 145, NULL, 0, 1),
(N'B2-035', N'B2 D區', 2, 145, NULL, 0, 1),
(N'B2-036', N'B2 D區', 2, 145, NULL, 0, 1),
(N'B2-037', N'B2 D區', 2, 145, NULL, 0, 1),
(N'B2-038', N'B2 D區', 2, 145, NULL, 0, 1),
(N'B2-039', N'B2 D區', 2, 145, NULL, 0, 1),
(N'B2-040', N'B2 D區', 2, 145, NULL, 0, 1),
(N'B2-041', N'B2 E區', 3, 1, N'EVB-7123', 0, 1),
(N'B2-042', N'B2 E區', 3, 2, N'EAC-3950', 0, 1),
(N'B2-043', N'B2 E區', 3, 3, N'EEX-8471', 0, 1),
(N'B2-044', N'B2 E區', 3, 4, N'EBM-6205', 0, 1),
(N'B2-045', N'B2 E區', 3, 5, N'EPL-9037', 0, 1),
(N'B2-046', N'B2 E區', 3, 6, N'ENX-2184', 0, 1),
(N'B2-047', N'B2 E區', 3, 7, N'EFD-7632', 0, 1),
(N'B2-048', N'B2 E區', 3, 8, N'EEQ-4395', 0, 1),
(N'B2-049', N'B2 E區', 3, 9, N'EGS-1109', 0, 1),
(N'B2-050', N'B2 E區', 3, 10, N'ETH-5740', 0, 1),
(N'B2-051', N'B2 F區', 3, 145, NULL, 0, 1),
(N'B2-052', N'B2 F區', 3, 145, NULL, 0, 1),
(N'B2-053', N'B2 F區', 3, 145, NULL, 0, 1),
(N'B2-054', N'B2 F區', 3, 145, NULL, 0, 1),
(N'B2-055', N'B2 F區', 3, 145, NULL, 0, 1),
(N'B2-056', N'B2 F區', 3, 145, NULL, 0, 1),
(N'B2-057', N'B2 F區', 3, 145, NULL, 0, 1),
(N'B2-058', N'B2 F區', 3, 145, NULL, 0, 1),
(N'B2-059', N'B2 F區', 3, 145, NULL, 0, 1),
(N'B2-060', N'B2 F區', 3, 145, NULL, 0, 1),

-- 公共車位 (可承租 用於抽籤)
(N'B4-001', N'B4 A區', 1, 145, NULL, 1, 1),
(N'B4-002', N'B4 A區', 1, 145, NULL, 1, 1),
(N'B4-003', N'B4 A區', 1, 145, NULL, 1, 1),
(N'B4-004', N'B4 A區', 1, 145, NULL, 1, 1),
(N'B4-005', N'B4 A區', 1, 145, NULL, 1, 1),
(N'B4-006', N'B4 A區', 1, 145, NULL, 1, 1),
(N'B4-007', N'B4 A區', 1, 145, NULL, 1, 1),
(N'B4-008', N'B4 A區', 1, 145, NULL, 1, 1),
(N'B4-009', N'B4 A區', 1, 145, NULL, 1, 1),
(N'B4-010', N'B4 A區', 1, 145, NULL, 1, 1),
(N'B4-011', N'B4 B區', 1, 145, NULL, 1, 1),
(N'B4-012', N'B4 B區', 1, 145, NULL, 1, 1),
(N'B4-013', N'B4 B區', 1, 145, NULL, 1, 1),
(N'B4-014', N'B4 B區', 1, 145, NULL, 1, 1),
(N'B4-015', N'B4 B區', 1, 145, NULL, 1, 1),
(N'B4-016', N'B4 B區', 1, 145, NULL, 1, 1),
(N'B4-017', N'B4 B區', 1, 145, NULL, 1, 1),
(N'B4-018', N'B4 B區', 1, 145, NULL, 1, 1),
(N'B4-019', N'B4 B區', 1, 145, NULL, 1, 1),
(N'B4-020', N'B4 B區', 1, 145, NULL, 1, 1),
(N'B4-021', N'B4 C區', 2, 145, NULL, 1, 1),
(N'B4-022', N'B4 C區', 2, 145, NULL, 1, 1),
(N'B4-023', N'B4 C區', 2, 145, NULL, 1, 1),
(N'B4-024', N'B4 C區', 2, 145, NULL, 1, 1),
(N'B4-025', N'B4 C區', 2, 145, NULL, 1, 1),
(N'B4-026', N'B4 C區', 2, 145, NULL, 1, 1),
(N'B4-027', N'B4 C區', 2, 145, NULL, 1, 1),
(N'B4-028', N'B4 C區', 2, 145, NULL, 1, 1),
(N'B4-029', N'B4 C區', 2, 145, NULL, 1, 1),
(N'B4-030', N'B4 C區', 2, 145, NULL, 1, 1),
(N'B4-031', N'B4 D區', 2, 145, NULL, 1, 1),
(N'B4-032', N'B4 D區', 2, 145, NULL, 1, 1),
(N'B4-033', N'B4 D區', 2, 145, NULL, 1, 1),
(N'B4-034', N'B4 D區', 2, 145, NULL, 1, 1),
(N'B4-035', N'B4 D區', 2, 145, NULL, 1, 1),
(N'B4-036', N'B4 D區', 2, 145, NULL, 1, 1),
(N'B4-037', N'B4 D區', 2, 145, NULL, 1, 1),
(N'B4-038', N'B4 D區', 2, 145, NULL, 1, 1),
(N'B4-039', N'B4 D區', 2, 145, NULL, 1, 1),
(N'B4-040', N'B4 D區', 2, 145, NULL, 1, 1),
(N'B4-041', N'B4 E區', 3, 145, NULL, 1, 1),
(N'B4-042', N'B4 E區', 3, 145, NULL, 1, 1),
(N'B4-043', N'B4 E區', 3, 145, NULL, 1, 1),
(N'B4-044', N'B4 E區', 3, 145, NULL, 1, 1),
(N'B4-045', N'B4 E區', 3, 145, NULL, 1, 1),
(N'B4-046', N'B4 E區', 3, 145, NULL, 1, 1),
(N'B4-047', N'B4 E區', 3, 145, NULL, 1, 1),
(N'B4-048', N'B4 E區', 3, 145, NULL, 1, 1),
(N'B4-049', N'B4 E區', 3, 145, NULL, 1, 1),
(N'B4-050', N'B4 E區', 3, 145, NULL, 1, 1),
(N'B4-051', N'B4 F區', 3, 145, NULL, 1, 1),
(N'B4-052', N'B4 F區', 3, 145, NULL, 1, 1),
(N'B4-053', N'B4 F區', 3, 145, NULL, 1, 1),
(N'B4-054', N'B4 F區', 3, 145, NULL, 1, 1),
(N'B4-055', N'B4 F區', 3, 145, NULL, 1, 1),
(N'B4-056', N'B4 F區', 3, 145, NULL, 1, 1),
(N'B4-057', N'B4 F區', 3, 145, NULL, 1, 1),
(N'B4-058', N'B4 F區', 3, 145, NULL, 1, 1),
(N'B4-059', N'B4 F區', 3, 145, NULL, 1, 1),
(N'B4-060', N'B4 F區', 3, 145, NULL, 1, 1);

CREATE TABLE parking_rentals (
    id INT IDENTITY(1,1) PRIMARY KEY,              -- 流水號

    community_id INT NOT NULL,                    -- 所屬社區
    parking_slot_id INT NOT NULL,                 -- 車位資料
    users_id INT NOT NULL,                        -- 承租者
    approved_id INT,                              -- 審核人，可為 NULL

    rent_buy_start DATE NOT NULL,                 -- 承租起始日
    rent_end DATE NOT NULL,                       -- 承租截止日
    license_plate NVARCHAR(10) NOT NULL,          -- 登記車牌
    status BIT NOT NULL,                          -- 繳費狀態
    approved BIT NOT NULL DEFAULT 0,              -- 是否已審核

    updated_at DATETIME,                          -- 最後更新時間
    created_at DATETIME DEFAULT GETDATE(),                          -- 創建時間

    -- 外鍵約束
    CONSTRAINT FK_rentals_community FOREIGN KEY (community_id)
        REFERENCES community(id),

    CONSTRAINT FK_rentals_slot FOREIGN KEY (parking_slot_id)
        REFERENCES parking_slot(id),

    CONSTRAINT FK_rentals_user FOREIGN KEY (users_id)
        REFERENCES users(users_id),

    CONSTRAINT FK_rentals_approver FOREIGN KEY (approved_id)
        REFERENCES users(users_id)
);

INSERT INTO parking_rentals (
    approved, created_at, license_plate,
    rent_buy_start, rent_end, [status], updated_at,
    approved_id, community_id, parking_slot_id, users_id
)
VALUES
-- 已審核承租紀錄
(1, '2025-03-10 09:00:00', N'LFX-3289', '2025-07-01', '2025-07-31', 1, '2025-03-10 16:30:00', 145, 1, 11, 1),
(1, '2025-03-10 09:00:00', N'MWT-1947', '2025-07-01', '2025-07-31', 1, '2025-03-10 16:30:00', 145, 1, 12, 2),
(1, '2025-03-10 09:00:00', N'ZKD-7061', '2025-07-01', '2025-07-31', 1, '2025-03-10 16:30:00', 145, 1, 13, 3),

(1, '2025-03-10 09:00:00', N'UP-6384', '2025-06-01', '2025-06-30', 1, '2025-03-10 16:30:00', 145, 1, 31, 1),
(1, '2025-03-10 09:00:00', N'AY-2975', '2025-06-01', '2025-06-30', 1, '2025-03-10 16:30:00', 145, 1, 32, 2),
(1, '2025-03-10 09:00:00', N'HM-8046', '2025-06-01', '2025-06-30', 1, '2025-03-10 16:30:00', 145, 1, 33, 3),

(1, '2025-03-10 09:00:00', N'ECL-2810', '2025-05-01', '2025-05-31', 1, '2025-03-10 16:30:00', 145, 1, 51, 1),
(1, '2025-03-10 09:00:00', N'EBR-7036', '2025-05-01', '2025-05-31', 1, '2025-03-10 16:30:00', 145, 1, 52, 2),
(1, '2025-03-10 09:00:00', N'EVK-9254', '2025-05-01', '2025-05-31', 1, '2025-03-10 16:30:00', 145, 1, 53, 3),


-- 未審核承租紀錄
(0, '2025-03-10 09:00:00', N'NBD-6302', '2025-08-01', '2025-08-31', 0, '2025-03-10 16:30:00', NULL, 1, 16, 1),
(0, '2025-03-10 09:00:00', N'TXR-9175', '2025-08-01', '2025-08-31', 0, '2025-03-10 16:30:00', NULL, 1, 17, 2),
(0, '2025-03-10 09:00:00', N'ZKD-7061', '2025-08-01', '2025-08-31', 0, '2025-03-10 16:30:00', NULL, 1, 18, 3),

(0, '2025-03-10 09:00:00', N'UP-6384', '2025-09-01', '2025-09-30', 0, '2025-03-10 16:30:00', NULL, 1, 36, 4),
(0, '2025-03-10 09:00:00', N'AY-2975', '2025-09-01', '2025-09-30', 0, '2025-03-10 16:30:00', NULL, 1, 37, 5),
(0, '2025-03-10 09:00:00', N'HM-8046', '2025-09-01', '2025-09-30', 0, '2025-03-10 16:30:00', NULL, 1, 38, 6),

(0, '2025-03-10 09:00:00', N'ECL-2810', '2025-10-01', '2025-10-31', 0, '2025-03-10 16:30:00', NULL, 1, 56, 7),
(0, '2025-03-10 09:00:00', N'EBR-7036', '2025-10-01', '2025-10-31', 0, '2025-03-10 16:30:00', NULL, 1, 57, 8),
(0, '2025-03-10 09:00:00', N'EVK-9254', '2025-10-01', '2025-10-31', 0, '2025-03-10 16:30:00', NULL, 1, 58, 9);




-- 先新增公告分類
INSERT INTO [finalProj].[dbo].[bulletin_category] (
    bulletin_category_name,
    community_id
)
VALUES ( N'抽籤', 1);

-- 這邊 IDENTITY 的 id 要跟車位抽籤的 id 對應
SET IDENTITY_INSERT bulletin ON;
INSERT INTO bulletin (
    bulletin_id, bulletin_description, bulletin_is_pinned, bulletin_modify_time,
    bulletin_post_status, bulletin_post_time, bulletin_remove_time,
    bulletin_title, bulletin_category_id, community_id, user_id
)
VALUES
-- 已發布
(101, N'請參考車位抽籤活動頁面：114年度7月機車位抽籤', NULL, '2025-05-01 16:30:00', 1, '2025-05-01 16:30:00', '2025-05-31 16:30:00', N'114年度7月機車位抽籤', 6, 1, 145), -- 結束
(102, N'請參考車位抽籤活動頁面：114年度8月電動車位抽籤', NULL, '2025-06-01 16:30:00', 1, '2025-06-01 16:30:00', '2025-06-30 16:30:00', N'114年度8月電動車位抽籤', 6, 1, 145), -- 未抽籤
(103, N'請參考車位抽籤活動頁面：114年度9月汽車位抽籤', NULL, '2025-07-01 16:30:00', 1, '2025-07-01 16:30:00', '2025-07-31 16:30:00', N'114年度9月汽車位抽籤', 6, 1, 145), -- 進行中

-- 未發布
(104, N'請參考車位抽籤活動頁面：114年度10月機車位抽籤', NULL, '2025-07-22 16:30:00', 0, '2025-08-01 16:30:00', '2025-08-31 16:30:00', N'114年度10月機車位抽籤', 6, 1, 145); -- 未開始

SET IDENTITY_INSERT bulletin OFF;


CREATE TABLE lottery_events (
    bulletin_id INT PRIMARY KEY,                          -- 與 Bulletin 共用主鍵

    users_id INT NOT NULL,                                -- 創建人
    parking_type_id INT NOT NULL,                         -- 車位種類

    title NVARCHAR(50) NOT NULL,                          -- 標題
    started_at DATETIME NOT NULL,                         -- 開始時間
    ended_at DATETIME NOT NULL,                           -- 結束時間
    created_at DATETIME DEFAULT GETDATE(),                -- 創建時間
	rental_start DATETIME NOT NULL,                       -- 承租開始時間
	rental_end DATETIME NOT NULL,                         -- 承租截止時間
    status BIT NOT NULL,                                  -- 是否已抽籤

    -- 外鍵約束
    CONSTRAINT FK_lottery_event_bulletin FOREIGN KEY (bulletin_id)
        REFERENCES [dbo].[bulletin](bulletin_id),                          -- bulletin.id 為主鍵

    CONSTRAINT FK_lottery_event_users FOREIGN KEY (users_id)
        REFERENCES users(users_id),

    CONSTRAINT FK_lottery_event_parking_type FOREIGN KEY (parking_type_id)
        REFERENCES parking_type(id)
);

INSERT INTO lottery_events (
    bulletin_id, created_at, started_at, ended_at, 
    [status], title, parking_type_id, users_id, rental_start, rental_end
)
VALUES
(101, '2025-04-01 16:30:00', '2025-05-01 16:30:00', '2025-05-31 16:30:00', 1, N'114年度7月機車位抽籤', 2, 145, '2025-07-01', '2025-09-30'),
(102, '2025-05-01 16:30:00', '2025-06-01 16:30:00', '2025-06-30 16:30:00', 0, N'114年度8月電動車位抽籤', 3, 145, '2025-08-01', '2025-10-31'),
(103, '2025-06-01 16:30:00', '2025-07-01 16:30:00', '2025-07-31 16:30:00', 0, N'114年度9月汽車位抽籤', 1, 145, '2024-09-01 ', '2024-11-30'),
(104, '2025-07-01 16:30:00', '2025-08-01 16:30:00', '2025-08-31 16:30:00', 0, N'114年度10月機車位抽籤', 2, 145, '2025-10-01', '2025-12-31');


CREATE TABLE lottery_event_spaces (
    id INT IDENTITY(1,1) PRIMARY KEY,               -- 流水號

    lottery_events_id INT NOT NULL,                -- 所屬抽籤活動（對應 bulletin_id）
    parking_slot_id INT NOT NULL,                  -- 對應車位資料

    -- 外鍵約束
    CONSTRAINT FK_event_space_event FOREIGN KEY (lottery_events_id)
        REFERENCES lottery_events(bulletin_id),

    CONSTRAINT FK_event_space_slot FOREIGN KEY (parking_slot_id)
        REFERENCES parking_slot(id)
);

INSERT INTO lottery_event_spaces (
    lottery_events_id, parking_slot_id
)
VALUES
-- 101 機車 141-160
(101, 141),
(101, 142),
(101, 143),
(101, 144),
(101, 145),
(101, 146),
(101, 147),
(101, 148),
(101, 149),
(101, 150),
(101, 151),
(101, 152),
(101, 153),
(101, 154),
(101, 155),
(101, 156),
(101, 157),
(101, 158),
(101, 159),
(101, 160),
-- 102 電動車 161-180
(102, 161),
(102, 162),
(102, 163),
(102, 164),
(102, 165),
(102, 166),
(102, 167),
(102, 168),
(102, 169),
(102, 170),
(102, 171),
(102, 172),
(102, 173),
(102, 174),
(102, 175),
(102, 176),
(102, 177),
(102, 178),
(102, 179),
(102, 180),
-- 103 汽車 121-140
(103, 121),
(103, 122),
(103, 123),
(103, 124),
(103, 125),
(103, 126),
(103, 127),
(103, 128),
(103, 129),
(103, 130),
(103, 131),
(103, 132),
(103, 133),
(103, 134),
(103, 135),
(103, 136),
(103, 137),
(103, 138),
(103, 139),
(103, 140),
-- 104 機車 141-160
(104, 141),
(104, 142),
(104, 143),
(104, 144),
(104, 145),
(104, 146),
(104, 147),
(104, 148),
(104, 149),
(104, 150),
(104, 151),
(104, 152),
(104, 153),
(104, 154),
(104, 155),
(104, 156),
(104, 157),
(104, 158),
(104, 159),
(104, 160);

-- 預留承租時間
INSERT INTO parking_rentals (
    approved, created_at, license_plate,
    rent_buy_start, rent_end, [status], updated_at,
    approved_id, community_id, parking_slot_id, users_id
)
VALUES
-- 抽籤預留承租紀錄 (已抽籤)
(0, '2025-04-01 16:30:00', N'', '2025-07-01', '2025-09-30', 0, '2025-06-01 16:30:00', NULL, 1, 141, 1),
(0, '2025-04-01 16:30:00', N'', '2025-07-01', '2025-09-30', 0, '2025-06-01 16:30:00', NULL, 1, 142, 2),
(0, '2025-04-01 16:30:00', N'', '2025-07-01', '2025-09-30', 0, '2025-06-01 16:30:00', NULL, 1, 143, 3),
(0, '2025-04-01 16:30:00', N'', '2025-07-01', '2025-09-30', 0, '2025-06-01 16:30:00', NULL, 1, 144, 4),
(0, '2025-04-01 16:30:00', N'', '2025-07-01', '2025-09-30', 0, '2025-06-01 16:30:00', NULL, 1, 145, 5),
(1, '2025-04-01 16:30:00', N'ABC-521', '2025-07-01', '2025-09-30', 1, '2025-06-01 16:30:00', 145, 1, 146, 6),
(1, '2025-04-01 16:30:00', N'236-FGK', '2025-07-01', '2025-09-30', 1, '2025-06-01 16:30:00', 145, 1, 147, 7),
(1, '2025-04-01 16:30:00', N'MNO-874', '2025-07-01', '2025-09-30', 1, '2025-06-01 16:30:00', 145, 1, 148, 8),
(1, '2025-04-01 16:30:00', N'589-KTL', '2025-07-01', '2025-09-30', 1, '2025-06-01 16:30:00', 145, 1, 149, 9),
(1, '2025-04-01 16:30:00', N'JIR-319', '2025-07-01', '2025-09-30', 1, '2025-06-01 16:30:00', 145, 1, 150, 10),
(1, '2025-04-01 16:30:00', N'274-CXA', '2025-07-01', '2025-09-30', 1, '2025-06-01 16:30:00', 145, 1, 151, 11),
(1, '2025-04-01 16:30:00', N'BTD-905', '2025-07-01', '2025-09-30', 1, '2025-06-01 16:30:00', 145, 1, 152, 12),
(1, '2025-04-01 16:30:00', N'145-ZKY', '2025-07-01', '2025-09-30', 1, '2025-06-01 16:30:00', 145, 1, 153, 13),
(1, '2025-04-01 16:30:00', N'PQE-762', '2025-07-01', '2025-09-30', 1, '2025-06-01 16:30:00', 145, 1, 154, 14),
(1, '2025-04-01 16:30:00', N'601-HVN', '2025-07-01', '2025-09-30', 1, '2025-06-01 16:30:00', 145, 1, 155, 15),

-- 抽籤預留承租紀錄 (未抽籤)
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 161, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 162, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 163, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 164, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 165, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 166, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 167, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 168, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 169, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 170, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 171, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 172, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 173, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 174, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 175, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 176, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 177, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 178, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 179, 145),
(1, '2025-05-01 16:30:00', N'抽籤車位', '2025-08-01', '2025-10-31', 0, '2025-05-01 16:30:00', 145, 1, 180, 145),

(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 121, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 122, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 123, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 124, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 125, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 126, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 127, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 128, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 129, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 130, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 131, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 132, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 133, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 134, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 135, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 136, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 137, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 138, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 139, 145),
(1, '2025-06-01 16:30:00', N'抽籤車位', '2024-09-01 ', '2024-11-30', 0, '2025-06-01 16:30:00', 145, 1, 140, 145),

(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 141, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 142, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 143, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 144, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 145, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 146, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 147, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 148, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 149, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 150, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 151, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 152, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 153, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 154, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 155, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 156, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 157, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 158, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 159, 145),
(1, '2025-07-01 16:30:00', N'抽籤車位', '2025-10-01', '2025-12-31', 0, '2025-07-01 16:30:00', 145, 1, 160, 145),

----------------------------------------------------------------讓我先睡覺zzz----------------------------------------------------------------
CREATE TABLE lottery_apply (
    id INT IDENTITY(1,1) PRIMARY KEY,               -- 流水號

    users_id INT NOT NULL,                          -- 申請人
    lottery_events_id INT NOT NULL,                 -- 所屬抽籤活動（對應 bulletin_id）
    lottery_event_spaces_id INT,                    -- 中籤車位，可為 NULL（尚未抽中）
    
    applied_at DATETIME                             -- 申請時間（可為 NULL）

    -- 外鍵約束
    CONSTRAINT FK_lottery_apply_users FOREIGN KEY (users_id)
        REFERENCES users(users_id),

    CONSTRAINT FK_lottery_apply_event FOREIGN KEY (lottery_events_id)
        REFERENCES lottery_events(bulletin_id),

    CONSTRAINT FK_lottery_apply_space FOREIGN KEY (lottery_event_spaces_id)
        REFERENCES lottery_event_spaces(id)
);


INSERT INTO lottery_apply (
    applied_at, lottery_event_spaces_id,
    lottery_events_id, users_id
)
VALUES
('2025-05-15 16:30:00', 1, 101, 1),
('2025-05-15 16:30:00', 2, 101, 2),
('2025-05-15 16:30:00', 3, 101, 3),
('2025-05-15 16:30:00', 4, 101, 4),
('2025-05-15 16:30:00', 5, 101, 5),
('2025-05-15 16:30:00', 6, 101, 6),
('2025-05-15 16:30:00', 7, 101, 7),
('2025-05-15 16:30:00', 8, 101, 8),
('2025-05-15 16:30:00', 9, 101, 9),
('2025-05-15 16:30:00', 10, 101, 10),
('2025-05-15 16:30:00', 11, 101, 11),
('2025-05-15 16:30:00', 12, 101, 12),
('2025-05-15 16:30:00', 13, 101, 13),
('2025-05-15 16:30:00', 14, 101, 14),
('2025-05-15 16:30:00', 15, 101, 15),
('2025-05-15 16:30:00', 16, 101, 16),
('2025-05-15 16:30:00', 17, 101, 17),
('2025-05-15 16:30:00', 18, 101, 18),
('2025-05-15 16:30:00', 19, 101, 19),
('2025-05-15 16:30:00', 20, 101, 20),
('2025-05-15 16:30:00', NULL, 101, 21),
('2025-05-15 16:30:00', NULL, 101, 22),
('2025-05-15 16:30:00', NULL, 101, 23),
('2025-05-15 16:30:00', NULL, 101, 24),
('2025-05-15 16:30:00', NULL, 101, 25),
('2025-05-15 16:30:00', NULL, 101, 26),
('2025-05-15 16:30:00', NULL, 101, 27),
('2025-05-15 16:30:00', NULL, 101, 28),
('2025-05-15 16:30:00', NULL, 101, 29),
('2025-05-15 16:30:00', NULL, 101, 30),

('2025-06-15 16:30:00', NULL, 102, 1),
('2025-06-15 16:30:00', NULL, 102, 2),
('2025-06-15 16:30:00', NULL, 102, 3),
('2025-06-15 16:30:00', NULL, 102, 4),
('2025-06-15 16:30:00', NULL, 102, 5),
('2025-06-15 16:30:00', NULL, 102, 6),
('2025-06-15 16:30:00', NULL, 102, 7),
('2025-06-15 16:30:00', NULL, 102, 8),
('2025-06-15 16:30:00', NULL, 102, 9),
('2025-06-15 16:30:00', NULL, 102, 10),
('2025-06-15 16:30:00', NULL, 102, 11),
('2025-06-15 16:30:00', NULL, 102, 12),
('2025-06-15 16:30:00', NULL, 102, 13),
('2025-06-15 16:30:00', NULL, 102, 14),
('2025-06-15 16:30:00', NULL, 102, 15),
('2025-06-15 16:30:00', NULL, 102, 16),
('2025-06-15 16:30:00', NULL, 102, 17),
('2025-06-15 16:30:00', NULL, 102, 18),
('2025-06-15 16:30:00', NULL, 102, 19),
('2025-06-15 16:30:00', NULL, 102, 20),
('2025-06-15 16:30:00', NULL, 102, 21),
('2025-06-15 16:30:00', NULL, 102, 22),
('2025-06-15 16:30:00', NULL, 102, 23),
('2025-06-15 16:30:00', NULL, 102, 24),
('2025-06-15 16:30:00', NULL, 102, 25),
('2025-06-15 16:30:00', NULL, 102, 26),
('2025-06-15 16:30:00', NULL, 102, 27),
('2025-06-15 16:30:00', NULL, 102, 28),
('2025-06-15 16:30:00', NULL, 102, 29),
('2025-06-15 16:30:00', NULL, 102, 30),

('2025-07-15 16:30:00', NULL, 103, 11),
('2025-07-15 16:30:00', NULL, 103, 12),
('2025-07-15 16:30:00', NULL, 103, 13),
('2025-07-15 16:30:00', NULL, 103, 14),
('2025-07-15 16:30:00', NULL, 103, 15),
('2025-07-15 16:30:00', NULL, 103, 16),
('2025-07-15 16:30:00', NULL, 103, 17),
('2025-07-15 16:30:00', NULL, 103, 18),
('2025-07-15 16:30:00', NULL, 103, 19),
('2025-07-15 16:30:00', NULL, 103, 20);